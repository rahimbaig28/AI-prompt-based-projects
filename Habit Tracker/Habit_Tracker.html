<!-- Prompt
 
Create a SINGLE HTML file (inline CSS + JS only; no external libs) named “Habit Tracker”.
Features:
- Add habits with color and icon (use emoji), track completion per day on a mini calendar.
- Show current streak and best streak per habit.
- Week and month summaries with completion percentages.
- Edit/Archive habits; localStorage persistence and “Reset all” control.
- Mobile-friendly grid and keyboard navigation for toggling days.
- Clear, modern UI with comments throughout. One file only.

-->

<!-- Features::

Dynamic Habit Management: Easily create, edit, and archive habits to fit your changing goals.

Customization: Personalize each habit with a unique name, emoji icon, and color for quick visual identification.

Interactive Calendar View: Track your progress daily on a clean, intuitive mini-calendar for the current month.

Streak Tracking: Stay motivated by automatically tracking your Current Streak and your all-time Best Streak for every habit.

Insightful Summaries: Get a high-level overview of your performance with weekly and monthly completion percentages calculated across all active habits.

Local Storage Persistence: Your data is automatically saved in your browser's localStorage, so your progress is always there when you return.

Responsive & Mobile-Friendly: The UI is fully responsive, providing a seamless experience on both desktop and mobile devices.

Accessible Keyboard Navigation: Navigate the calendar grid using arrow keys and toggle a day's completion with the Spacebar or Enter key.

Zero Dependencies: The entire application runs from a single HTML file with vanilla JavaScript and CSS. No external libraries or frameworks are needed.

Data Control: A simple "Reset All Data" option with a confirmation step gives you full control to start over anytime.
-->



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker</title>
    
    <style>
        /* CSS Variables for easy theming */
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #1c1e21;
            --primary-color: #0866ff;
            --primary-hover: #0652cc;
            --secondary-text: #606770;
            --border-color: #dddfe2;
            --shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 16px;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        /* Main container and header styles */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        header h1 {
            font-size: 2rem;
            margin: 0;
        }

        /* Button styles */
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        .btn:hover {
            background-color: var(--primary-hover);
        }

        .btn-secondary {
            background-color: #e4e6eb;
            color: var(--text-color);
        }
        .btn-secondary:hover {
            background-color: #d8dbdf;
        }

        .btn-danger {
            background-color: #e41e3f;
        }
        .btn-danger:hover {
            background-color: #c91a38;
        }

        /* Habit Grid Layout */
        #habit-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }

        .habit-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            border-top: 5px solid var(--habit-color, var(--primary-color));
        }

        .habit-card.archived {
            opacity: 0.5;
        }

        /* Habit Header */
        .habit-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .habit-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .habit-icon {
            font-size: 2.5rem;
        }

        .habit-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }

        .habit-actions .btn {
            font-size: 0.8rem;
            padding: 4px 8px;
        }
        
        /* Streaks and Stats */
        .streaks {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            color: var(--secondary-text);
        }

        .streaks div {
            text-align: center;
        }

        .streaks .value {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
            color: var(--text-color);
        }

        /* Mini Calendar */
        .calendar-container h3 {
            margin: 0 0 10px 0;
            font-size: 1rem;
            color: var(--secondary-text);
            font-weight: 500;
            text-align: center;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .day-header, .day {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 35px;
            border-radius: 50%;
            font-size: 0.8rem;
        }
        
        .day-header {
            font-weight: 600;
            color: var(--secondary-text);
        }

        .day {
            cursor: pointer;
            background-color: var(--bg-color);
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .day.empty {
            background-color: transparent;
            cursor: default;
        }

        .day.completed {
            background-color: var(--habit-color, var(--primary-color));
            color: white;
            font-weight: bold;
        }
        
        .day:not(.empty):focus {
            border-color: var(--primary-color);
            outline: none;
            transform: scale(1.1);
        }
        
        .day.today {
            border-color: var(--secondary-text);
        }
        
        .day.today.completed {
             border-color: white;
        }

        /* Summary Section */
        .summary-section {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-top: 20px;
        }
        
        .summary-section h2 {
            margin-top: 0;
        }

        .summary-stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 500px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .form-group input[type="text"],
        .form-group input[type="color"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-sizing: border-box;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Icon/Color pickers */
        .picker-container {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-top: 5px;
        }
        .picker-item {
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            font-size: 1.2rem;
            transition: background-color 0.2s;
        }
        .picker-item:hover {
            background-color: #eee;
        }
        
        /* Empty State */
        #empty-state {
            text-align: center;
            padding: 50px;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        /* Footer / Settings */
        footer {
            text-align: center;
            margin-top: 40px;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Habit Tracker</h1>
            <button class="btn" id="add-habit-btn">✨ Add New Habit</button>
        </header>

        <main>
            <div id="habit-grid"></div>
            <div id="empty-state" style="display: none;">
                <h2>Welcome!</h2>
                <p>You haven't added any habits yet. Click "Add New Habit" to get started.</p>
            </div>
        </main>

        <section class="summary-section" id="summary-section">
            <h2>This Month's Summary</h2>
            <div class="summary-stats">
                <div>
                    <strong>This Week:</strong> <span id="week-summary">N/A</span>
                </div>
                <div>
                    <strong>This Month:</strong> <span id="month-summary">N/A</span>
                </div>
            </div>
        </section>

        <footer>
             <button class="btn btn-danger" id="reset-all-btn">Reset All Data</button>
        </footer>
    </div>

    <div id="habit-modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title">Add a New Habit</h2>
            <form id="habit-form">
                <input type="hidden" id="habit-id">
                <div class="form-group">
                    <label for="habit-name">Habit Name</label>
                    <input type="text" id="habit-name" placeholder="e.g., Read for 15 minutes" required>
                </div>
                <div class="form-group">
                    <label for="habit-icon">Icon (Emoji)</label>
                    <input type="text" id="habit-icon" value="🎯" required>
                     <div id="icon-picker" class="picker-container"></div>
                </div>
                <div class="form-group">
                    <label for="habit-color">Color</label>
                    <input type="color" id="habit-color" value="#0866ff">
                    <div id="color-picker" class="picker-container"></div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn" id="save-btn">Save Habit</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- DOM ELEMENT REFERENCES ---
            const habitGrid = document.getElementById('habit-grid');
            const addHabitBtn = document.getElementById('add-habit-btn');
            const habitModal = document.getElementById('habit-modal');
            const habitForm = document.getElementById('habit-form');
            const cancelBtn = document.getElementById('cancel-btn');
            const modalTitle = document.getElementById('modal-title');
            const habitIdInput = document.getElementById('habit-id');
            const habitNameInput = document.getElementById('habit-name');
            const habitIconInput = document.getElementById('habit-icon');
            const habitColorInput = document.getElementById('habit-color');
            const resetAllBtn = document.getElementById('reset-all-btn');
            const emptyState = document.getElementById('empty-state');
            const summarySection = document.getElementById('summary-section');
            const weekSummaryEl = document.getElementById('week-summary');
            const monthSummaryEl = document.getElementById('month-summary');

            // --- STATE MANAGEMENT ---
            let habits = []; // Main data array
            const DB_NAME = 'habitsDB'; // localStorage key

            // --- UTILITY & HELPER FUNCTIONS ---

            /**
             * Get today's date in 'YYYY-MM-DD' format.
             * @returns {string} The formatted date string.
             */
            const getTodayString = () => new Date().toISOString().slice(0, 10);

            /**
             * Load habits from localStorage.
             */
            const loadHabits = () => {
                const data = localStorage.getItem(DB_NAME);
                habits = data ? JSON.parse(data) : [];
            };

            /**
             * Save habits to localStorage.
             */
            const saveHabits = () => {
                localStorage.setItem(DB_NAME, JSON.stringify(habits));
            };

            // --- MODAL HANDLING ---
            const openModal = (habit = null) => {
                habitForm.reset();
                if (habit) {
                    // Editing an existing habit
                    modalTitle.textContent = 'Edit Habit';
                    habitIdInput.value = habit.id;
                    habitNameInput.value = habit.name;
                    habitIconInput.value = habit.icon;
                    habitColorInput.value = habit.color;
                } else {
                    // Adding a new habit
                    modalTitle.textContent = 'Add New Habit';
                    habitIdInput.value = '';
                    // Set default emoji and color
                    habitIconInput.value = '🎯';
                    habitColorInput.value = '#0866ff';
                }
                populatePickers(); // Populate color/icon suggestions
                habitModal.style.display = 'flex';
                habitNameInput.focus();
            };

            const closeModal = () => {
                habitModal.style.display = 'none';
            };
            
            // --- DATA MANIPULATION ---

            /**
             * Toggles a date's completion status for a given habit.
             * @param {number} id - The ID of the habit.
             * @param {string} dateString - The date in 'YYYY-MM-DD' format.
             */
            const toggleDateCompletion = (id, dateString) => {
                const habit = habits.find(h => h.id === id);
                if (!habit) return;

                const dateIndex = habit.dates.indexOf(dateString);
                if (dateIndex > -1) {
                    habit.dates.splice(dateIndex, 1); // Remove date
                } else {
                    habit.dates.push(dateString); // Add date
                }
                saveAndRender();
            };

            // --- STREAK AND SUMMARY CALCULATIONS ---
            
            /**
             * Calculates the current and best streaks for a habit.
             * @param {string[]} dates - An array of 'YYYY-MM-DD' date strings.
             * @returns {{current: number, best: number}}
             */
            const calculateStreaks = (dates) => {
                if (dates.length === 0) return { current: 0, best: 0 };
                
                // Sort dates and convert to Date objects for reliable comparison
                const sortedDates = dates.map(d => new Date(d)).sort((a, b) => a - b);

                let bestStreak = 0;
                let currentStreak = 0;
                let today = new Date();
                today.setHours(0,0,0,0); // Normalize to start of day

                let lastDate = null;
                
                for (let i = 0; i < sortedDates.length; i++) {
                    const date = sortedDates[i];
                    date.setHours(0,0,0,0);

                    if (lastDate) {
                        // Check if the current date is one day after the last
                        const diff = (date.getTime() - lastDate.getTime()) / (1000 * 3600 * 24);
                        if (diff === 1) {
                            currentStreak++;
                        } else {
                            // Streak broken
                            bestStreak = Math.max(bestStreak, currentStreak);
                            currentStreak = 1;
                        }
                    } else {
                        currentStreak = 1;
                    }
                    lastDate = date;
                }
                
                bestStreak = Math.max(bestStreak, currentStreak);

                // Check if current streak extends to today or yesterday
                const todayStr = getTodayString();
                const yesterday = new Date(today);
                yesterday.setDate(today.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().slice(0, 10);
                
                const lastDateStr = dates.sort().pop();
                
                if (lastDateStr !== todayStr && lastDateStr !== yesterdayStr) {
                    currentStreak = 0;
                }
                // If the only completion is today, streak should be 1
                if(dates.includes(todayStr) && dates.length === 1) {
                    currentStreak = 1;
                }

                return { current: currentStreak, best: bestStreak };
            };
            
            /**
             * Calculates and displays week and month completion summaries.
             */
            const calculateAndRenderSummaries = () => {
                const activeHabits = habits.filter(h => !h.archived);
                if(activeHabits.length === 0) {
                    weekSummaryEl.textContent = 'N/A';
                    monthSummaryEl.textContent = 'N/A';
                    return;
                }
                
                const today = new Date();
                const startOfWeek = new Date(today);
                startOfWeek.setDate(today.getDate() - today.getDay());
                const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);

                let weekCompletions = 0;
                let weekTotalDays = 0;
                let monthCompletions = 0;
                let monthTotalDays = 0;

                for (const habit of activeHabits) {
                    for (const dateStr of habit.dates) {
                        const date = new Date(dateStr);
                        if (date >= startOfWeek) weekCompletions++;
                        if (date >= startOfMonth) monthCompletions++;
                    }
                }
                
                const daysInWeek = today.getDay() + 1;
                const daysInMonth = today.getDate();
                weekTotalDays = activeHabits.length * daysInWeek;
                monthTotalDays = activeHabits.length * daysInMonth;

                const weekPercentage = weekTotalDays > 0 ? ((weekCompletions / weekTotalDays) * 100).toFixed(0) : 0;
                const monthPercentage = monthTotalDays > 0 ? ((monthCompletions / monthTotalDays) * 100).toFixed(0) : 0;
                
                weekSummaryEl.textContent = `${weekPercentage}% (${weekCompletions}/${weekTotalDays})`;
                monthSummaryEl.textContent = `${monthPercentage}% (${monthCompletions}/${monthTotalDays})`;
            };

            // --- RENDERING LOGIC ---

            /**
             * Renders all habits to the DOM.
             */
            const renderHabits = () => {
                habitGrid.innerHTML = '';
                const activeHabits = habits.filter(h => !h.archived);
                const archivedHabits = habits.filter(h => h.archived);

                if (habits.length === 0) {
                    emptyState.style.display = 'block';
                    summarySection.style.display = 'none';
                } else {
                    emptyState.style.display = 'none';
                    summarySection.style.display = 'block';
                }

                // Render active habits first, then archived
                [...activeHabits, ...archivedHabits].forEach(habit => {
                    const card = document.createElement('div');
                    card.className = 'habit-card';
                    card.style.setProperty('--habit-color', habit.color);
                    if (habit.archived) {
                        card.classList.add('archived');
                    }

                    const streaks = calculateStreaks(habit.dates);
                    const today = new Date();
                    const monthName = today.toLocaleString('default', { month: 'long' });
                    const year = today.getFullYear();
                    
                    card.innerHTML = `
                        <div class="habit-header">
                            <div class="habit-info">
                                <span class="habit-icon">${habit.icon}</span>
                                <h2 class="habit-title">${habit.name}</h2>
                            </div>
                            <div class="habit-actions">
                                <button class="btn btn-secondary edit-btn" data-id="${habit.id}">Edit</button>
                                <button class="btn btn-secondary archive-btn" data-id="${habit.id}">${habit.archived ? 'Unarchive' : 'Archive'}</button>
                            </div>
                        </div>
                        <div class="streaks">
                            <div>
                                <span class="value">${streaks.current}</span>
                                <span>Current Streak</span>
                            </div>
                            <div>
                                <span class="value">${streaks.best}</span>
                                <span>Best Streak</span>
                            </div>
                        </div>
                        <div class="calendar-container">
                            <h3>${monthName} ${year}</h3>
                            <div class="calendar-grid" data-habit-id="${habit.id}">
                                ${generateCalendarGrid(habit)}
                            </div>
                        </div>
                    `;
                    habitGrid.appendChild(card);
                });
                
                calculateAndRenderSummaries();
            };

            /**
             * Generates the HTML for a mini calendar grid for a habit.
             * @param {object} habit - The habit object.
             * @returns {string} The HTML string for the grid.
             */
            const generateCalendarGrid = (habit) => {
                const today = new Date();
                const todayStr = getTodayString();
                const year = today.getFullYear();
                const month = today.getMonth();

                const firstDayOfMonth = new Date(year, month, 1);
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const startDayOfWeek = firstDayOfMonth.getDay(); // 0=Sun, 1=Mon, ...
                
                let gridHTML = ['S', 'M', 'T', 'W', 'T', 'F', 'S'].map(d => `<div class="day-header">${d}</div>`).join('');
                
                // Add empty cells for days before the 1st of the month
                for (let i = 0; i < startDayOfWeek; i++) {
                    gridHTML += '<div class="day empty"></div>';
                }

                // Add day cells
                for (let i = 1; i <= daysInMonth; i++) {
                    const date = new Date(year, month, i);
                    const dateString = date.toISOString().slice(0, 10);
                    const isCompleted = habit.dates.includes(dateString);
                    const isToday = (dateString === todayStr);

                    gridHTML += `
                        <button 
                            class="day ${isCompleted ? 'completed' : ''} ${isToday ? 'today' : ''}" 
                            data-date="${dateString}"
                            aria-label="Toggle completion for ${date.toDateString()}"
                            tabindex="-1"
                        >${i}</button>
                    `;
                }
                return gridHTML;
            };

            /**
             * Populates the icon and color pickers in the modal.
             */
            const populatePickers = () => {
                const iconPicker = document.getElementById('icon-picker');
                const colorPicker = document.getElementById('color-picker');
                const icons = ['🎯', '📚', '💪', '🧘', '💧', '🏃', '🎨', '💻', '✅', '⭐'];
                const colors = ['#0866ff', '#e41e3f', '#f7b928', '#45bd62', '#8a3ab9', '#606770', '#31a24c', '#fa383e'];
                
                iconPicker.innerHTML = icons.map(icon => `<div class="picker-item" data-icon="${icon}">${icon}</div>`).join('');
                colorPicker.innerHTML = colors.map(color => `<div class="picker-item" data-color="${color}" style="background-color:${color}; width:24px; height:24px;"></div>`).join('');
            };
            
            // --- EVENT LISTENERS ---

            addHabitBtn.addEventListener('click', () => openModal());
            cancelBtn.addEventListener('click', closeModal);
            habitModal.addEventListener('click', (e) => {
                if (e.target === habitModal) closeModal();
            });

            // Handle icon and color picker clicks using event delegation
            document.getElementById('icon-picker').addEventListener('click', (e) => {
                if(e.target.dataset.icon) {
                    habitIconInput.value = e.target.dataset.icon;
                }
            });
             document.getElementById('color-picker').addEventListener('click', (e) => {
                if(e.target.dataset.color) {
                    habitColorInput.value = e.target.dataset.color;
                }
            });

            // Handle saving a new or edited habit
            habitForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const id = habitIdInput.value;
                const newHabit = {
                    id: id ? parseInt(id) : Date.now(),
                    name: habitNameInput.value.trim(),
                    icon: habitIconInput.value.trim(),
                    color: habitColorInput.value,
                    archived: id ? habits.find(h => h.id === parseInt(id)).archived : false,
                    dates: id ? habits.find(h => h.id === parseInt(id)).dates : [],
                };
                
                if (!newHabit.name || !newHabit.icon) return; // Basic validation

                if (id) {
                    // Update existing habit
                    habits = habits.map(h => (h.id === newHabit.id ? newHabit : h));
                } else {
                    // Add new habit
                    habits.push(newHabit);
                }
                
                closeModal();
                saveAndRender();
            });

            // Handle all clicks on the habit grid (day toggles, edit, archive)
            habitGrid.addEventListener('click', (e) => {
                const target = e.target;
                
                // Toggle a day's completion
                if (target.classList.contains('day') && !target.classList.contains('empty')) {
                    const habitId = parseInt(target.closest('.calendar-grid').dataset.habitId);
                    const date = target.dataset.date;
                    toggleDateCompletion(habitId, date);
                }

                // Edit button
                if (target.classList.contains('edit-btn')) {
                    const habitId = parseInt(target.dataset.id);
                    const habitToEdit = habits.find(h => h.id === habitId);
                    openModal(habitToEdit);
                }

                // Archive/Unarchive button
                if (target.classList.contains('archive-btn')) {
                    const habitId = parseInt(target.dataset.id);
                    const habit = habits.find(h => h.id === habitId);
                    if (habit) {
                        habit.archived = !habit.archived;
                        saveAndRender();
                    }
                }
            });
            
            // Handle Keyboard Navigation within a calendar grid
            habitGrid.addEventListener('keydown', (e) => {
                const target = e.target;
                if (!target.classList.contains('day')) return;
                
                const grid = target.closest('.calendar-grid');
                const days = Array.from(grid.querySelectorAll('.day:not(.empty)'));
                const currentIndex = days.indexOf(target);
                
                let nextIndex = -1;

                switch (e.key) {
                    case 'ArrowRight':
                        nextIndex = currentIndex + 1;
                        break;
                    case 'ArrowLeft':
                        nextIndex = currentIndex - 1;
                        break;
                    case 'ArrowDown':
                        nextIndex = currentIndex + 7;
                        break;
                    case 'ArrowUp':
                        nextIndex = currentIndex - 7;
                        break;
                    case ' ': // Space bar toggles completion
                    case 'Enter':
                        e.preventDefault(); // Prevent form submission or scrolling
                        target.click();
                        return;
                    default:
                        return; // Exit if not an arrow key
                }
                e.preventDefault(); // Prevent page scrolling

                if (nextIndex >= 0 && nextIndex < days.length) {
                    days[nextIndex].focus();
                }
            });


            // Reset all data
            resetAllBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to delete all your habit data? This cannot be undone.')) {
                    habits = [];
                    saveAndRender();
                }
            });


            // --- INITIALIZATION ---
            
            /**
             * Saves the current state and re-renders the entire UI.
             */
            const saveAndRender = () => {
                saveHabits();
                renderHabits();
            };

            // Initial load and render
            loadHabits();
            renderHabits();
        });
    </script>
</body>
</html>